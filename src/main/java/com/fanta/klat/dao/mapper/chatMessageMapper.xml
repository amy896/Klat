<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fanta.klat.dao.ChatMessageDao">

	<insert id="insertChatMessage" parameterType="chatMessage">
		insert into tbl_chat_message
		(cm_content, cm_type, cm_write_date, cr_num, m_num)
		values(#{cmContent}, #{cmType}, #{cmWriteDate}, #{crNum}, #{mNum})
		<selectKey order="AFTER" keyProperty="cmNum" resultType="int">
			select last_insert_id()
		</selectKey>
	</insert>
	
	<select id="selectAllChatMessageByCrNum" parameterType="int" resultMap="chatMessageMap">
		select cm_content, cm_type, cm_write_date, m_num
		from tbl_chat_message
		where cr_num = #{crNum}
	</select>
	
	<resultMap id="chatMessageMap" type="chatMessage">
		<result column="cm_num" property="cmNum" />
		<result column="cm_content" property="cmContent" />
		<result column="cm_type" property="cmType" />
		<result column="cm_write_date" property="cmWriteDate" />
		<result column="cr_num" property="crNum" />
		<result column="m_num" property="mNum" />
	</resultMap>
</mapper>